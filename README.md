# 文件操作
小窍门：[VS如何在一个项目中添加多个包含main函数的源文件并分别调试运行](https://blog.csdn.net/qq_30815237/article/details/87452311)  
### 代码1 [以只读方式打开文件](file1.cpp)  
注意：  
1 绝对路径中的/与\  
2 解决窗口一闪而过的问题  
3 只要用fopen打开的文件，就一定要用fclose关掉（打开失败就不用关闭），参数就是fopen的返回值  
4 在进行文件读写的时候有时可能会失败，首先要考虑文件权限的问题（只读、只写），不要先去检查代码错误  
### 代码2 [getc读取txt文件字节并输出](file2.cpp)  
注意：  
1 getc特点：每次读取一个字节,再次调用时会读取下一个字节  
2 使用while(1)的死循环不断读取txt文件的字节并输出  
3 c语言的内部定义中，txt文件的结束标识是-1，即一个宏EOF  
```
# define EOF -1  
```
读取字节并输出有两种表达方式：  
```
		while(1)
		{
			char c = getc(p);
			if (c == EOF)
				break;
			printf("%c",c);
		}
```
```
    char c =getc(p)
		while(c != EOF)
		{
    	printf("%c",c);
			char c = getc(p);
		}
```
### 代码3 [putc向txt文件写入字节](file3.cpp)  
1 putc注意要用w方式打开，getc用r方式打开，第一次运行就犯了这个错误！！！  
2 putc写入时原来的txt文件内容会被覆盖  
### 代码4 [打开用户指定的文件，用户向文件中输入字符，直到‘0’时停止](file4.cpp)
1 在我编写if语句时出现的问题  
```
if (argc <2)
	return 0;
FILE *p = fopen(args[1],"w");
```
上述语句与下述语句是等价的，但是上述语句更简洁，在编写后续代码的时候也不会有过多{}和对齐的问题,编写代码时采用上述方式  
```
if (argc <2)
	return 0;
else
	FILE *p = fopen(args[1],"w");
```
### 代码5 [文件拷贝](file5.cpp)
### 代码6 [fputs写字符](file6.cpp)
1 fputs可以写一个字符串，putc只能写一个字节  
### 代码7 [fgets读字符](file7.cpp)  
### 代码8 [feof判断是否到文件结尾](file8.cpp)
1 feof到文件结尾为真，只要！feof（p）就表示没有到结尾，循环就继续  
### 代码9 [向文件txt写入随机数](file9.cpp)
1 随机数种子srand((unsigned int)time(NULL));需要加头文件time.h  
只需在主程序开始处调用srand((unsigned)time(NULL)); 后面直接用rand就可以了  
2 加for循环控制输出的数的数量  
3 想要输出在0-256范围内的数？除以256取余（取余的数不可能大于256，因此得到的结果范围在0到256）  
### 代码10 [读txt文件中的数组，排序后再写入文件中](file10.cpp)
1 p不能重定义，新建文件p进行读操作关闭后，再进行写操作，无需用FILE进行定义  
```
FILE *p = fopen("a.txt", "r");
fclose(p);
p = fopen("a.txt","w");
fclose(p);
```
2 新建交换函数和排序函数，在主函数中进行调用  
3 fgets读的是字符串，需要把字符串转换成数组进行排序操作  
4 排序完成后要向文件中写入数组，需要把数组转换成字符串再进行写入  
### 代码11 [统计某个数出现的次数](file11.cpp)
### 代码12 [解析文件内容并追加结果](file12.cpp)
txt文件内容如下：  
1+2=  
3-4=  
···  
### 代码13 [代码12改进-将结果输送回txt文件](file13.cpp)
### 代码14 [fscanf与fprintf](file14.cpp)
1 printf：向标准输出设备输出 sprintf：向字符串输出 fprintf：向文件输出  
2 fscanf: 从文件中读取字符串并转义  
### 代码15 [解析文本文件内容](file15.cpp)
txt的文本内容如下：  
姓名=张三,年龄=10  
姓名=李四,年龄=20  
...  
两个函数：strtok(把字符串分成两部分得到第一部分）strchr（把字符串分成两部分得到第二部分）  
### 代码16 [练习：输出年龄第二大的人的姓名](file16.cpp)
1 首先实现功能，输出数组中第二大的数[代码17](file17.cpp)  
### 代码18 [stat函数得到文件信息](file18.cpp)
1 需要的头文件  
```
#include <sys/types.h>
#include <sys/stat.h>
#include <unistd.h>
```
### 代码19 [fread与fwrite](file19.cpp)
1 fgets fputs fprintf fscanf这些函数都是针对文本读写的，不能对一个二进制文件进行读写  
2 除了文本文件之外都是二进制文件，比如图像、可执行程序、音乐都是二进制文件  
3 之前所学的内容都是往文件里写入字符串，如果要把一个int整数写入文件，这个文件就不是文本文件了  
4 怎样把一个整数写到文件里？用fwrite函数  
5 fread的返回值是成功读取到的单位个数  
### 代码20 [fopen的a模式](file20.cpp)  
1 a模式：如果文件存在，往文件后面追加内容，如果文件不存在则创建一个新的文件，而w模式会覆盖原来的文件，直接新建，无论原来的文件是否存在  
### 21 fopen的b模式
1 windows所有的文本文件都是以\r\n结尾的，而不是以\n结尾的，读文件的时候如果用“r”参数系统会自动吃掉\n前的\r，用rb模式就不会吃掉  
2 用w模式去写，在\n前系统会自动添加\r,如果用wb就不会自动添加  
3 b模式只对windows文件有效，在linux下无效（以\n结尾），所以说有时候把linux下的文件拿到windows下打开时会发现不换行  
4 在windows下进行读写，如果是一个二进制的文件一般要加b，防止系统添加\r,如果读写的是一个文本文件，就不要添加b  

## 小结  
1 如果只调用fopen，不调用fclose：一个程序可以同时打开的文件数是有限的，多个文件对内存消耗很大，如果超过系统限制，打开文件就会失败  
2 文本文件可以用EOF来判断是否结尾  
3 fprintf fscanf fgets fputs都是针对文本文件行的读取函数  
4 fread fwrite针对二进制文件的读写  


